{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shivansh%20Rana/Desktop/DTU%20Academic/Codes/WEBD/SIH25008/frontend/src/app/utils/authDiagnostics.js"],"sourcesContent":["/**\r\n * Authentication Diagnostics Utility\r\n * \r\n * This utility provides functions to help diagnose authentication issues\r\n * in the application. It includes tools for token validation, API testing,\r\n * and network diagnostics.\r\n */\r\n\r\n/**\r\n * Checks if a JWT token is valid and not expired\r\n * @param {string} token - The JWT token to validate\r\n * @returns {Object} - Token validity information\r\n */\r\nexport const validateToken = (token) => {\r\n  if (!token) {\r\n    return { valid: false, error: 'No token provided' };\r\n  }\r\n  \r\n  try {\r\n    // Split the token into parts\r\n    const parts = token.split('.');\r\n    if (parts.length !== 3) {\r\n      return { valid: false, error: 'Invalid token format' };\r\n    }\r\n    \r\n    // Decode the payload (middle part)\r\n    const payload = JSON.parse(atob(parts[1]));\r\n    \r\n    // Check expiration\r\n    const currentTime = Math.floor(Date.now() / 1000);\r\n    if (payload.exp && payload.exp < currentTime) {\r\n      return { \r\n        valid: false, \r\n        error: 'Token expired', \r\n        expiredAt: new Date(payload.exp * 1000).toLocaleString(),\r\n        currentTime: new Date().toLocaleString()\r\n      };\r\n    }\r\n    \r\n    return { \r\n      valid: true, \r\n      payload,\r\n      expiresAt: payload.exp ? new Date(payload.exp * 1000).toLocaleString() : 'No expiration'\r\n    };\r\n  } catch (error) {\r\n    return { valid: false, error: `Token validation error: ${error.message}` };\r\n  }\r\n};\r\n\r\n/**\r\n * Tests the API endpoint with the provided token\r\n * @param {string} endpoint - The API endpoint to test\r\n * @param {string} token - The JWT token to use for authentication\r\n * @returns {Promise<Object>} - API test results\r\n */\r\nexport const testApiEndpoint = async (endpoint, token) => {\r\n  const startTime = performance.now();\r\n  const results = { endpoint, success: false, timing: {} };\r\n  \r\n  try {\r\n    // Make the request with timing information\r\n    const response = await fetch(endpoint, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': token ? `Bearer ${token}` : '',\r\n        'Content-Type': 'application/json',\r\n      },\r\n      cache: 'no-store'\r\n    });\r\n    \r\n    const endTime = performance.now();\r\n    results.timing.total = `${(endTime - startTime).toFixed(2)}ms`;\r\n    \r\n    // Get response details\r\n    results.status = response.status;\r\n    results.statusText = response.statusText;\r\n    results.headers = {};\r\n    \r\n    // Convert headers to object\r\n    response.headers.forEach((value, key) => {\r\n      results.headers[key] = value;\r\n    });\r\n    \r\n    // Try to parse response body\r\n    try {\r\n      results.data = await response.json();\r\n    } catch (e) {\r\n      results.data = 'Could not parse response as JSON';\r\n    }\r\n    \r\n    results.success = response.ok;\r\n    return results;\r\n  } catch (error) {\r\n    const endTime = performance.now();\r\n    results.timing.total = `${(endTime - startTime).toFixed(2)}ms`;\r\n    results.error = error.message;\r\n    return results;\r\n  }\r\n};\r\n\r\n/**\r\n * Runs a comprehensive authentication diagnostic\r\n * @returns {Promise<Object>} - Diagnostic results\r\n */\r\nexport const runAuthDiagnostic = async () => {\r\n  const results = {\r\n    timestamp: new Date().toISOString(),\r\n    environment: {},\r\n    localStorage: {},\r\n    tokenValidation: {},\r\n    apiTests: []\r\n  };\r\n  \r\n  // Check environment\r\n  results.environment = {\r\n    nextPublicApiUrl: process.env.NEXT_PUBLIC_API_URL || 'Not set',\r\n    baseUrl: window.location.origin,\r\n    userAgent: navigator.userAgent\r\n  };\r\n  \r\n  // Check localStorage\r\n  try {\r\n    const storedUser = localStorage.getItem('user');\r\n    if (storedUser) {\r\n      const user = JSON.parse(storedUser);\r\n      results.localStorage.user = {\r\n        found: true,\r\n        hasToken: !!user.token,\r\n        tokenPreview: user.token ? `${user.token.substring(0, 10)}...` : 'No token',\r\n        role: user.role || 'Not specified'\r\n      };\r\n      \r\n      // Validate token\r\n      if (user.token) {\r\n        results.tokenValidation = validateToken(user.token);\r\n      }\r\n      \r\n      // Test API endpoints\r\n      const endpoints = [\r\n        '/api/users/profile',\r\n        '/api/auth/verify'\r\n      ];\r\n      \r\n      for (const endpoint of endpoints) {\r\n        const apiResult = await testApiEndpoint(endpoint, user.token);\r\n        results.apiTests.push(apiResult);\r\n      }\r\n    } else {\r\n      results.localStorage.user = { found: false };\r\n    }\r\n  } catch (error) {\r\n    results.localStorage.error = error.message;\r\n  }\r\n  \r\n  return results;\r\n};\r\n\r\n/**\r\n * Logs diagnostic information to console in a formatted way\r\n * @param {Object} diagnosticResults - Results from runAuthDiagnostic\r\n */\r\nexport const logDiagnosticResults = (diagnosticResults) => {\r\n  console.group('üîç Authentication Diagnostic Results');\r\n  console.log('Timestamp:', diagnosticResults.timestamp);\r\n  \r\n  console.group('Environment');\r\n  console.table(diagnosticResults.environment);\r\n  console.groupEnd();\r\n  \r\n  console.group('LocalStorage');\r\n  console.table(diagnosticResults.localStorage.user || diagnosticResults.localStorage.error);\r\n  console.groupEnd();\r\n  \r\n  if (diagnosticResults.tokenValidation.valid !== undefined) {\r\n    console.group('Token Validation');\r\n    console.table(diagnosticResults.tokenValidation);\r\n    console.groupEnd();\r\n  }\r\n  \r\n  console.group('API Tests');\r\n  diagnosticResults.apiTests.forEach((test, index) => {\r\n    console.group(`Test ${index + 1}: ${test.endpoint}`);\r\n    console.log('Status:', test.status, test.statusText);\r\n    console.log('Timing:', test.timing.total);\r\n    console.log('Success:', test.success);\r\n    if (test.error) console.error('Error:', test.error);\r\n    console.log('Response:', test.data);\r\n    console.groupEnd();\r\n  });\r\n  console.groupEnd();\r\n  \r\n  console.groupEnd();\r\n};\r\n\r\n/**\r\n * Run and log diagnostics in one step\r\n * @returns {Promise<Object>} - Diagnostic results\r\n */\r\nexport const diagnoseAuthIssues = async () => {\r\n  const results = await runAuthDiagnostic();\r\n  logDiagnosticResults(results);\r\n  return results;\r\n};"],"names":[],"mappings":"AAAA;;;;;;CAMC,GAED;;;;CAIC;;;;;;;;;;;;AACM,MAAM,gBAAgB,CAAC;IAC5B,IAAI,CAAC,OAAO;QACV,OAAO;YAAE,OAAO;YAAO,OAAO;QAAoB;IACpD;IAEA,IAAI;QACF,6BAA6B;QAC7B,MAAM,QAAQ,MAAM,KAAK,CAAC;QAC1B,IAAI,MAAM,MAAM,KAAK,GAAG;YACtB,OAAO;gBAAE,OAAO;gBAAO,OAAO;YAAuB;QACvD;QAEA,mCAAmC;QACnC,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,KAAK,CAAC,EAAE;QAExC,mBAAmB;QACnB,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;QAC5C,IAAI,QAAQ,GAAG,IAAI,QAAQ,GAAG,GAAG,aAAa;YAC5C,OAAO;gBACL,OAAO;gBACP,OAAO;gBACP,WAAW,IAAI,KAAK,QAAQ,GAAG,GAAG,MAAM,cAAc;gBACtD,aAAa,IAAI,OAAO,cAAc;YACxC;QACF;QAEA,OAAO;YACL,OAAO;YACP;YACA,WAAW,QAAQ,GAAG,GAAG,IAAI,KAAK,QAAQ,GAAG,GAAG,MAAM,cAAc,KAAK;QAC3E;IACF,EAAE,OAAO,OAAO;QACd,OAAO;YAAE,OAAO;YAAO,OAAO,CAAC,wBAAwB,EAAE,MAAM,OAAO,EAAE;QAAC;IAC3E;AACF;AAQO,MAAM,kBAAkB,OAAO,UAAU;IAC9C,MAAM,YAAY,YAAY,GAAG;IACjC,MAAM,UAAU;QAAE;QAAU,SAAS;QAAO,QAAQ,CAAC;IAAE;IAEvD,IAAI;QACF,2CAA2C;QAC3C,MAAM,WAAW,MAAM,MAAM,UAAU;YACrC,QAAQ;YACR,SAAS;gBACP,iBAAiB,QAAQ,CAAC,OAAO,EAAE,OAAO,GAAG;gBAC7C,gBAAgB;YAClB;YACA,OAAO;QACT;QAEA,MAAM,UAAU,YAAY,GAAG;QAC/B,QAAQ,MAAM,CAAC,KAAK,GAAG,GAAG,CAAC,UAAU,SAAS,EAAE,OAAO,CAAC,GAAG,EAAE,CAAC;QAE9D,uBAAuB;QACvB,QAAQ,MAAM,GAAG,SAAS,MAAM;QAChC,QAAQ,UAAU,GAAG,SAAS,UAAU;QACxC,QAAQ,OAAO,GAAG,CAAC;QAEnB,4BAA4B;QAC5B,SAAS,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO;YAC/B,QAAQ,OAAO,CAAC,IAAI,GAAG;QACzB;QAEA,6BAA6B;QAC7B,IAAI;YACF,QAAQ,IAAI,GAAG,MAAM,SAAS,IAAI;QACpC,EAAE,OAAO,GAAG;YACV,QAAQ,IAAI,GAAG;QACjB;QAEA,QAAQ,OAAO,GAAG,SAAS,EAAE;QAC7B,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,UAAU,YAAY,GAAG;QAC/B,QAAQ,MAAM,CAAC,KAAK,GAAG,GAAG,CAAC,UAAU,SAAS,EAAE,OAAO,CAAC,GAAG,EAAE,CAAC;QAC9D,QAAQ,KAAK,GAAG,MAAM,OAAO;QAC7B,OAAO;IACT;AACF;AAMO,MAAM,oBAAoB;IAC/B,MAAM,UAAU;QACd,WAAW,IAAI,OAAO,WAAW;QACjC,aAAa,CAAC;QACd,cAAc,CAAC;QACf,iBAAiB,CAAC;QAClB,UAAU,EAAE;IACd;IAEA,oBAAoB;IACpB,QAAQ,WAAW,GAAG;QACpB,kBAAkB,6DAAmC;QACrD,SAAS,OAAO,QAAQ,CAAC,MAAM;QAC/B,WAAW,UAAU,SAAS;IAChC;IAEA,qBAAqB;IACrB,IAAI;QACF,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,YAAY;YACd,MAAM,OAAO,KAAK,KAAK,CAAC;YACxB,QAAQ,YAAY,CAAC,IAAI,GAAG;gBAC1B,OAAO;gBACP,UAAU,CAAC,CAAC,KAAK,KAAK;gBACtB,cAAc,KAAK,KAAK,GAAG,GAAG,KAAK,KAAK,CAAC,SAAS,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG;gBACjE,MAAM,KAAK,IAAI,IAAI;YACrB;YAEA,iBAAiB;YACjB,IAAI,KAAK,KAAK,EAAE;gBACd,QAAQ,eAAe,GAAG,cAAc,KAAK,KAAK;YACpD;YAEA,qBAAqB;YACrB,MAAM,YAAY;gBAChB;gBACA;aACD;YAED,KAAK,MAAM,YAAY,UAAW;gBAChC,MAAM,YAAY,MAAM,gBAAgB,UAAU,KAAK,KAAK;gBAC5D,QAAQ,QAAQ,CAAC,IAAI,CAAC;YACxB;QACF,OAAO;YACL,QAAQ,YAAY,CAAC,IAAI,GAAG;gBAAE,OAAO;YAAM;QAC7C;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,YAAY,CAAC,KAAK,GAAG,MAAM,OAAO;IAC5C;IAEA,OAAO;AACT;AAMO,MAAM,uBAAuB,CAAC;IACnC,QAAQ,KAAK,CAAC;IACd,QAAQ,GAAG,CAAC,cAAc,kBAAkB,SAAS;IAErD,QAAQ,KAAK,CAAC;IACd,QAAQ,KAAK,CAAC,kBAAkB,WAAW;IAC3C,QAAQ,QAAQ;IAEhB,QAAQ,KAAK,CAAC;IACd,QAAQ,KAAK,CAAC,kBAAkB,YAAY,CAAC,IAAI,IAAI,kBAAkB,YAAY,CAAC,KAAK;IACzF,QAAQ,QAAQ;IAEhB,IAAI,kBAAkB,eAAe,CAAC,KAAK,KAAK,WAAW;QACzD,QAAQ,KAAK,CAAC;QACd,QAAQ,KAAK,CAAC,kBAAkB,eAAe;QAC/C,QAAQ,QAAQ;IAClB;IAEA,QAAQ,KAAK,CAAC;IACd,kBAAkB,QAAQ,CAAC,OAAO,CAAC,CAAC,MAAM;QACxC,QAAQ,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE,EAAE,KAAK,QAAQ,EAAE;QACnD,QAAQ,GAAG,CAAC,WAAW,KAAK,MAAM,EAAE,KAAK,UAAU;QACnD,QAAQ,GAAG,CAAC,WAAW,KAAK,MAAM,CAAC,KAAK;QACxC,QAAQ,GAAG,CAAC,YAAY,KAAK,OAAO;QACpC,IAAI,KAAK,KAAK,EAAE,QAAQ,KAAK,CAAC,UAAU,KAAK,KAAK;QAClD,QAAQ,GAAG,CAAC,aAAa,KAAK,IAAI;QAClC,QAAQ,QAAQ;IAClB;IACA,QAAQ,QAAQ;IAEhB,QAAQ,QAAQ;AAClB;AAMO,MAAM,qBAAqB;IAChC,MAAM,UAAU,MAAM;IACtB,qBAAqB;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shivansh%20Rana/Desktop/DTU%20Academic/Codes/WEBD/SIH25008/frontend/src/app/utils/apiTester.js"],"sourcesContent":["/**\r\n * API Testing Utility\r\n * \r\n * This utility provides functions to test API endpoints and diagnose connection issues.\r\n */\r\n\r\n/**\r\n * Tests an API endpoint with various configurations\r\n * @param {string} endpoint - The API endpoint to test\r\n * @param {Object} options - Test options\r\n * @returns {Promise<Object>} - Test results\r\n */\r\nexport const testApiEndpoint = async (endpoint, options = {}) => {\r\n  const {\r\n    method = 'GET',\r\n    token = null,\r\n    body = null,\r\n    baseUrls = [\r\n      '', // Relative URL (uses Next.js API routes)\r\n      'http://localhost:5000', // Direct backend URL\r\n      process.env.NEXT_PUBLIC_API_URL || '' // Environment variable URL\r\n    ],\r\n    timeout = 5000,\r\n    includeCredentials = true\r\n  } = options;\r\n  \r\n  const results = [];\r\n  \r\n  // Test each base URL\r\n  for (const baseUrl of baseUrls) {\r\n    if (!baseUrl && baseUrls.length > 1) continue; // Skip empty base URL if we have alternatives\r\n    \r\n    const fullUrl = `${baseUrl}${endpoint}`;\r\n    const result = {\r\n      url: fullUrl,\r\n      success: false,\r\n      status: null,\r\n      statusText: null,\r\n      timing: null,\r\n      error: null,\r\n      data: null\r\n    };\r\n    \r\n    try {\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n      \r\n      const startTime = performance.now();\r\n      \r\n      const fetchOptions = {\r\n        method,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          ...(token ? { 'Authorization': `Bearer ${token}` } : {})\r\n        },\r\n        ...(body ? { body: JSON.stringify(body) } : {}),\r\n        ...(includeCredentials ? { credentials: 'include' } : {}),\r\n        signal: controller.signal\r\n      };\r\n      \r\n      const response = await fetch(fullUrl, fetchOptions);\r\n      clearTimeout(timeoutId);\r\n      \r\n      const endTime = performance.now();\r\n      result.timing = `${(endTime - startTime).toFixed(2)}ms`;\r\n      \r\n      result.status = response.status;\r\n      result.statusText = response.statusText;\r\n      \r\n      // Try to parse response as JSON\r\n      try {\r\n        result.data = await response.json();\r\n      } catch (e) {\r\n        // If not JSON, get text\r\n        result.data = await response.text();\r\n      }\r\n      \r\n      result.success = response.ok;\r\n    } catch (error) {\r\n      result.error = error.name === 'AbortError' \r\n        ? `Request timed out after ${timeout}ms` \r\n        : error.message;\r\n    }\r\n    \r\n    results.push(result);\r\n  }\r\n  \r\n  return results;\r\n};\r\n\r\n/**\r\n * Tests all critical API endpoints and returns results\r\n * @param {string} token - JWT token for authenticated requests\r\n * @returns {Promise<Object>} - Test results for all endpoints\r\n */\r\nexport const testAllEndpoints = async (token = null) => {\r\n  const endpoints = [\r\n    { path: '/api/users/profile', method: 'GET', requiresAuth: true },\r\n    { path: '/api/auth/login', method: 'POST', requiresAuth: false, body: { email: 'test@example.com', password: 'password' } },\r\n    { path: '/api/auth/refresh', method: 'POST', requiresAuth: false, body: { token } }\r\n  ];\r\n  \r\n  const results = {};\r\n  \r\n  for (const endpoint of endpoints) {\r\n    const options = {\r\n      method: endpoint.method,\r\n      ...(endpoint.requiresAuth && token ? { token } : {}),\r\n      ...(endpoint.body ? { body: endpoint.body } : {})\r\n    };\r\n    \r\n    results[endpoint.path] = await testApiEndpoint(endpoint.path, options);\r\n  }\r\n  \r\n  return results;\r\n};\r\n\r\n/**\r\n * Logs API test results to console in a formatted way\r\n * @param {Object} results - Results from testAllEndpoints\r\n */\r\nexport const logApiTestResults = (results) => {\r\n  console.group('üîå API Connection Test Results');\r\n  \r\n  for (const [endpoint, tests] of Object.entries(results)) {\r\n    console.group(`Endpoint: ${endpoint}`);\r\n    \r\n    tests.forEach((test, index) => {\r\n      console.group(`Test ${index + 1}: ${test.url}`);\r\n      console.log(`Status: ${test.status || 'N/A'} ${test.statusText || ''}`);\r\n      console.log(`Success: ${test.success}`);\r\n      console.log(`Timing: ${test.timing || 'N/A'}`);\r\n      \r\n      if (test.error) {\r\n        console.error(`Error: ${test.error}`);\r\n      }\r\n      \r\n      if (test.data) {\r\n        console.log('Response data:', test.data);\r\n      }\r\n      \r\n      console.groupEnd();\r\n    });\r\n    \r\n    console.groupEnd();\r\n  }\r\n  \r\n  console.groupEnd();\r\n};\r\n\r\n/**\r\n * Run and log API tests in one step\r\n * @param {string} token - JWT token for authenticated requests\r\n * @returns {Promise<Object>} - Test results\r\n */\r\nexport const runApiTests = async (token = null) => {\r\n  const results = await testAllEndpoints(token);\r\n  logApiTestResults(results);\r\n  return results;\r\n};"],"names":[],"mappings":"AAAA;;;;CAIC,GAED;;;;;CAKC;;;;;;;;;;AACM,MAAM,kBAAkB,OAAO,UAAU,UAAU,CAAC,CAAC;IAC1D,MAAM,EACJ,SAAS,KAAK,EACd,QAAQ,IAAI,EACZ,OAAO,IAAI,EACX,WAAW;QACT;QACA;QACA,6DAAmC,GAAG,2BAA2B;KAClE,EACD,UAAU,IAAI,EACd,qBAAqB,IAAI,EAC1B,GAAG;IAEJ,MAAM,UAAU,EAAE;IAElB,qBAAqB;IACrB,KAAK,MAAM,WAAW,SAAU;QAC9B,IAAI,CAAC,WAAW,SAAS,MAAM,GAAG,GAAG,UAAU,8CAA8C;QAE7F,MAAM,UAAU,GAAG,UAAU,UAAU;QACvC,MAAM,SAAS;YACb,KAAK;YACL,SAAS;YACT,QAAQ;YACR,YAAY;YACZ,QAAQ;YACR,OAAO;YACP,MAAM;QACR;QAEA,IAAI;YACF,MAAM,aAAa,IAAI;YACvB,MAAM,YAAY,WAAW,IAAM,WAAW,KAAK,IAAI;YAEvD,MAAM,YAAY,YAAY,GAAG;YAEjC,MAAM,eAAe;gBACnB;gBACA,SAAS;oBACP,gBAAgB;oBAChB,GAAI,QAAQ;wBAAE,iBAAiB,CAAC,OAAO,EAAE,OAAO;oBAAC,IAAI,CAAC,CAAC;gBACzD;gBACA,GAAI,OAAO;oBAAE,MAAM,KAAK,SAAS,CAAC;gBAAM,IAAI,CAAC,CAAC;gBAC9C,GAAI,qBAAqB;oBAAE,aAAa;gBAAU,IAAI,CAAC,CAAC;gBACxD,QAAQ,WAAW,MAAM;YAC3B;YAEA,MAAM,WAAW,MAAM,MAAM,SAAS;YACtC,aAAa;YAEb,MAAM,UAAU,YAAY,GAAG;YAC/B,OAAO,MAAM,GAAG,GAAG,CAAC,UAAU,SAAS,EAAE,OAAO,CAAC,GAAG,EAAE,CAAC;YAEvD,OAAO,MAAM,GAAG,SAAS,MAAM;YAC/B,OAAO,UAAU,GAAG,SAAS,UAAU;YAEvC,gCAAgC;YAChC,IAAI;gBACF,OAAO,IAAI,GAAG,MAAM,SAAS,IAAI;YACnC,EAAE,OAAO,GAAG;gBACV,wBAAwB;gBACxB,OAAO,IAAI,GAAG,MAAM,SAAS,IAAI;YACnC;YAEA,OAAO,OAAO,GAAG,SAAS,EAAE;QAC9B,EAAE,OAAO,OAAO;YACd,OAAO,KAAK,GAAG,MAAM,IAAI,KAAK,eAC1B,CAAC,wBAAwB,EAAE,QAAQ,EAAE,CAAC,GACtC,MAAM,OAAO;QACnB;QAEA,QAAQ,IAAI,CAAC;IACf;IAEA,OAAO;AACT;AAOO,MAAM,mBAAmB,OAAO,QAAQ,IAAI;IACjD,MAAM,YAAY;QAChB;YAAE,MAAM;YAAsB,QAAQ;YAAO,cAAc;QAAK;QAChE;YAAE,MAAM;YAAmB,QAAQ;YAAQ,cAAc;YAAO,MAAM;gBAAE,OAAO;gBAAoB,UAAU;YAAW;QAAE;QAC1H;YAAE,MAAM;YAAqB,QAAQ;YAAQ,cAAc;YAAO,MAAM;gBAAE;YAAM;QAAE;KACnF;IAED,MAAM,UAAU,CAAC;IAEjB,KAAK,MAAM,YAAY,UAAW;QAChC,MAAM,UAAU;YACd,QAAQ,SAAS,MAAM;YACvB,GAAI,SAAS,YAAY,IAAI,QAAQ;gBAAE;YAAM,IAAI,CAAC,CAAC;YACnD,GAAI,SAAS,IAAI,GAAG;gBAAE,MAAM,SAAS,IAAI;YAAC,IAAI,CAAC,CAAC;QAClD;QAEA,OAAO,CAAC,SAAS,IAAI,CAAC,GAAG,MAAM,gBAAgB,SAAS,IAAI,EAAE;IAChE;IAEA,OAAO;AACT;AAMO,MAAM,oBAAoB,CAAC;IAChC,QAAQ,KAAK,CAAC;IAEd,KAAK,MAAM,CAAC,UAAU,MAAM,IAAI,OAAO,OAAO,CAAC,SAAU;QACvD,QAAQ,KAAK,CAAC,CAAC,UAAU,EAAE,UAAU;QAErC,MAAM,OAAO,CAAC,CAAC,MAAM;YACnB,QAAQ,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE,EAAE,KAAK,GAAG,EAAE;YAC9C,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,IAAI,MAAM,CAAC,EAAE,KAAK,UAAU,IAAI,IAAI;YACtE,QAAQ,GAAG,CAAC,CAAC,SAAS,EAAE,KAAK,OAAO,EAAE;YACtC,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,KAAK,MAAM,IAAI,OAAO;YAE7C,IAAI,KAAK,KAAK,EAAE;gBACd,QAAQ,KAAK,CAAC,CAAC,OAAO,EAAE,KAAK,KAAK,EAAE;YACtC;YAEA,IAAI,KAAK,IAAI,EAAE;gBACb,QAAQ,GAAG,CAAC,kBAAkB,KAAK,IAAI;YACzC;YAEA,QAAQ,QAAQ;QAClB;QAEA,QAAQ,QAAQ;IAClB;IAEA,QAAQ,QAAQ;AAClB;AAOO,MAAM,cAAc,OAAO,QAAQ,IAAI;IAC5C,MAAM,UAAU,MAAM,iBAAiB;IACvC,kBAAkB;IAClB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shivansh%20Rana/Desktop/DTU%20Academic/Codes/WEBD/SIH25008/frontend/src/app/components/AuthDiagnosticTool.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { diagnoseAuthIssues, validateToken } from '../utils/authDiagnostics';\r\nimport { runApiTests } from '../utils/apiTester';\r\n\r\n/**\r\n * A diagnostic tool component that helps debug authentication issues\r\n * Can be added to any page where authentication debugging is needed\r\n */\r\nconst AuthDiagnosticTool = () => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [results, setResults] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isApiTesting, setIsApiTesting] = useState(false);\r\n  const [apiTestResults, setApiTestResults] = useState(null);\r\n  const [manualToken, setManualToken] = useState('');\r\n  const [tokenValidation, setTokenValidation] = useState(null);\r\n\r\n  const runDiagnostics = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const diagnosticResults = await diagnoseAuthIssues();\r\n      setResults(diagnosticResults);\r\n    } catch (error) {\r\n      console.error('Error running diagnostics:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  const testApiConnections = async () => {\r\n    setIsApiTesting(true);\r\n    try {\r\n      // Get token from localStorage if available\r\n      let token = null;\r\n      try {\r\n        const user = JSON.parse(localStorage.getItem('user'));\r\n        if (user && user.token) {\r\n          token = user.token;\r\n        }\r\n      } catch (e) {\r\n        console.error('Error getting token from localStorage:', e);\r\n      }\r\n      \r\n      const results = await runApiTests(token);\r\n      setApiTestResults(results);\r\n    } catch (error) {\r\n      console.error('Error testing API connections:', error);\r\n    } finally {\r\n      setIsApiTesting(false);\r\n    }\r\n  };\r\n\r\n  const validateManualToken = () => {\r\n    if (!manualToken.trim()) {\r\n      setTokenValidation({ valid: false, error: 'No token provided' });\r\n      return;\r\n    }\r\n\r\n    const validation = validateToken(manualToken);\r\n    setTokenValidation(validation);\r\n  };\r\n\r\n  const clearLocalStorage = () => {\r\n    localStorage.removeItem('user');\r\n    alert('Local storage cleared. You will need to log in again.');\r\n    window.location.href = '/login';\r\n  };\r\n\r\n  if (!isOpen) {\r\n    return (\r\n      <button \r\n        onClick={() => setIsOpen(true)}\r\n        className=\"fixed bottom-4 right-4 bg-gray-800 text-white p-2 rounded-full shadow-lg z-50 opacity-70 hover:opacity-100 transition-opacity\"\r\n        title=\"Auth Diagnostics\"\r\n      >\r\n        üîç\r\n      </button>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-auto\">\r\n        <div className=\"sticky top-0 bg-gray-100 p-4 border-b flex justify-between items-center\">\r\n          <h2 className=\"text-xl font-bold\">Authentication Diagnostic Tool</h2>\r\n          <button \r\n            onClick={() => setIsOpen(false)}\r\n            className=\"text-gray-500 hover:text-gray-700\"\r\n          >\r\n            ‚úï\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-6 space-y-6\">\r\n          <div className=\"space-y-4\">\r\n            <h3 className=\"text-lg font-semibold\">Run Diagnostics</h3>\r\n            <p className=\"text-gray-600\">This will check your authentication status, token validity, and API connectivity.</p>\r\n            <div className=\"flex space-x-4\">\r\n              <button\r\n                onClick={runDiagnostics}\r\n                disabled={isLoading}\r\n                className=\"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50\"\r\n              >\r\n                {isLoading ? 'Running...' : 'Run Auth Diagnostics'}\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testApiConnections}\r\n                disabled={isApiTesting}\r\n                className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50\"\r\n              >\r\n                {isApiTesting ? 'Testing...' : 'Test API Connections'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {apiTestResults && (\r\n            <div className=\"border rounded-lg p-4 bg-gray-50 space-y-4\">\r\n              <h3 className=\"text-lg font-semibold\">API Test Results</h3>\r\n              \r\n              {Object.entries(apiTestResults).map(([endpoint, tests]) => (\r\n                <div key={endpoint} className=\"mb-4\">\r\n                  <h4 className=\"font-medium\">{endpoint}</h4>\r\n                  \r\n                  {tests.map((test, index) => (\r\n                    <div key={index} className=\"mb-2 bg-white p-2 rounded border\">\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"font-medium\">{test.url}</span>\r\n                        <span className={`px-2 py-0.5 rounded text-sm ${test.success ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\r\n                          {test.status || 'Failed'} {test.statusText || ''}\r\n                        </span>\r\n                      </div>\r\n                      {test.error && (\r\n                        <div className=\"text-red-600 text-sm mt-1\">{test.error}</div>\r\n                      )}\r\n                      <div className=\"text-gray-500 text-sm\">Response time: {test.timing || 'N/A'}</div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n          \r\n          {results && (\r\n            <div className=\"border rounded-lg p-4 bg-gray-50 space-y-4\">\r\n              <h3 className=\"text-lg font-semibold\">Results</h3>\r\n              \r\n              <div>\r\n                <h4 className=\"font-medium\">Environment</h4>\r\n                <div className=\"bg-white p-2 rounded border overflow-x-auto\">\r\n                  <pre className=\"text-sm\">{JSON.stringify(results.environment, null, 2)}</pre>\r\n                </div>\r\n              </div>\r\n              \r\n              <div>\r\n                <h4 className=\"font-medium\">LocalStorage User</h4>\r\n                <div className=\"bg-white p-2 rounded border overflow-x-auto\">\r\n                  <pre className=\"text-sm\">{JSON.stringify(results.localStorage, null, 2)}</pre>\r\n                </div>\r\n              </div>\r\n              \r\n              {results.tokenValidation && results.tokenValidation.valid !== undefined && (\r\n                <div>\r\n                  <h4 className=\"font-medium\">Token Validation</h4>\r\n                  <div className={`p-2 rounded border ${results.tokenValidation.valid ? 'bg-green-50' : 'bg-red-50'}`}>\r\n                    {results.tokenValidation.valid ? (\r\n                      <div className=\"text-green-700\">‚úì Token is valid</div>\r\n                    ) : (\r\n                      <div className=\"text-red-700\">‚úó {results.tokenValidation.error}</div>\r\n                    )}\r\n                    <pre className=\"text-sm mt-2 bg-white p-2 rounded\">{JSON.stringify(results.tokenValidation, null, 2)}</pre>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              <div>\r\n                <h4 className=\"font-medium\">API Tests</h4>\r\n                {results.apiTests.map((test, index) => (\r\n                  <div key={index} className=\"mb-2 bg-white p-2 rounded border\">\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"font-medium\">{test.endpoint}</span>\r\n                      <span className={`px-2 py-0.5 rounded text-sm ${test.success ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\r\n                        {test.status} {test.statusText}\r\n                      </span>\r\n                    </div>\r\n                    {test.error && (\r\n                      <div className=\"text-red-600 text-sm mt-1\">{test.error}</div>\r\n                    )}\r\n                    <div className=\"text-gray-500 text-sm\">Response time: {test.timing.total}</div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"border-t pt-4\">\r\n            <h3 className=\"text-lg font-semibold mb-4\">Manual Token Validation</h3>\r\n            <div className=\"space-y-2\">\r\n              <textarea\r\n                value={manualToken}\r\n                onChange={(e) => setManualToken(e.target.value)}\r\n                placeholder=\"Paste JWT token here\"\r\n                className=\"w-full p-2 border rounded h-24\"\r\n              />\r\n              <button\r\n                onClick={validateManualToken}\r\n                className=\"bg-gray-700 hover:bg-gray-800 text-white px-4 py-2 rounded\"\r\n              >\r\n                Validate Token\r\n              </button>\r\n            </div>\r\n            \r\n            {tokenValidation && (\r\n              <div className={`mt-4 p-3 rounded ${tokenValidation.valid ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}`}>\r\n                {tokenValidation.valid ? (\r\n                  <div>\r\n                    <div className=\"text-green-700 font-medium\">‚úì Token is valid</div>\r\n                    <div className=\"text-sm mt-1\">Expires: {tokenValidation.expiresAt}</div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"text-red-700\">\r\n                    ‚úó {tokenValidation.error}\r\n                    {tokenValidation.expiredAt && (\r\n                      <div className=\"text-sm mt-1\">\r\n                        Expired at: {tokenValidation.expiredAt}<br />\r\n                        Current time: {tokenValidation.currentTime}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n          \r\n          <div className=\"border-t pt-4\">\r\n            <h3 className=\"text-lg font-semibold mb-2\">Troubleshooting Actions</h3>\r\n            <div className=\"space-y-2\">\r\n              <button\r\n                onClick={clearLocalStorage}\r\n                className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded\"\r\n              >\r\n                Clear Auth Data & Redirect to Login\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AuthDiagnosticTool;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 989, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shivansh%20Rana/Desktop/DTU%20Academic/Codes/WEBD/SIH25008/frontend/src/app/dashboard/student/page.js"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { useRouter } from 'next/navigation';\r\nimport { FaBook, FaCalendarAlt, FaClipboardList, FaBell, FaUserCircle } from 'react-icons/fa';\r\nimport AuthDiagnosticTool from '@/app/components/AuthDiagnosticTool';\r\n\r\nexport default function StudentDashboard() {\r\n  const { user, loading, getUserProfile, logout } = useAuth();\r\n  const router = useRouter();\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  \r\nuseEffect(() => {\r\n  // If not loading and no user, redirect to login\r\n  if (!loading && !user) {\r\n    console.log('No user detected, redirecting to login');\r\n    router.push('/login');\r\n    return; // Early return prevents further execution\r\n  }\r\n  \r\n  // If user exists, get the latest profile data\r\n  if (user) {\r\n    let isMounted = true; // Flag to track component mount state\r\n    \r\n    // Set loading state before API call\r\n    setIsLoading(true);\r\n    \r\n    // Add a small delay to prevent rapid consecutive calls\r\n    const timeoutId = setTimeout(async () => {\r\n      try {\r\n        // Get user profile data with allowRetry=false to prevent infinite loops\r\n        const profileData = await getUserProfile(false);\r\n        \r\n        // If component unmounted during the API call, don't update state\r\n        if (!isMounted) {\r\n          console.log('Component unmounted, skipping state updates');\r\n          return;\r\n        }\r\n        \r\n        console.log('Profile loaded successfully');\r\n        setIsLoading(false);\r\n        \r\n        // If profile data is null, redirect to login\r\n        if (!profileData) {\r\n          console.log('No profile data returned, redirecting to login');\r\n          router.push('/login');\r\n          return;\r\n        }\r\n        \r\n        // Verify user role is student, redirect otherwise\r\n        if (profileData.role !== 'student') {\r\n          console.log('User is not a student, redirecting');\r\n          router.push(`/dashboard/${profileData.role}`);\r\n          return;\r\n        }\r\n      } catch (error) {\r\n        // Only update state and redirect if component is still mounted\r\n        if (isMounted) {\r\n          console.error('Error fetching user profile:', error);\r\n          setIsLoading(false);\r\n          router.push('/login');\r\n        }\r\n      }\r\n    }, 300);\r\n    \r\n    // Cleanup function to handle unmounting\r\n    return () => {\r\n      console.log('Dashboard useEffect cleanup - preventing state updates after unmount');\r\n      clearTimeout(timeoutId);\r\n      isMounted = false;\r\n    };\r\n  } else {\r\n    setIsLoading(false);\r\n  }\r\n}, []); // getUserProfile is intentionally excluded from dependencies to prevent infinite loops\r\n  \r\n  // Show loading spinner when fetching profile\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4\">\r\n        <div className=\"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4\"></div>\r\n        <p className=\"text-gray-600 text-lg\">Loading student dashboard...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const renderTabContent = () => {\r\n    switch(activeTab) {\r\n      case 'overview':\r\n        return (\r\n          <div className=\"bg-white rounded-xl shadow-lg p-6 w-full\">\r\n            <h2 className=\"text-2xl font-bold mb-6 text-gray-800 border-b pb-2\">Overview</h2>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n              <div className=\"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl shadow-md border border-blue-200 transform transition-transform hover:scale-105\">\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"bg-gradient-to-r from-blue-500 to-blue-600 rounded-full p-4 mr-4 shadow-md\">\r\n                    <FaBook className=\"text-white text-xl\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-medium text-gray-700\">Courses</h3>\r\n                    <p className=\"text-3xl font-bold text-blue-600\">4</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl shadow-md border border-green-200 transform transition-transform hover:scale-105\">\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"bg-gradient-to-r from-green-500 to-green-600 rounded-full p-4 mr-4 shadow-md\">\r\n                    <FaClipboardList className=\"text-white text-xl\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-medium text-gray-700\">Assignments</h3>\r\n                    <p className=\"text-3xl font-bold text-green-600\">7</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl shadow-md border border-purple-200 transform transition-transform hover:scale-105\">\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"bg-gradient-to-r from-purple-500 to-purple-600 rounded-full p-4 mr-4 shadow-md\">\r\n                    <FaCalendarAlt className=\"text-white text-xl\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-medium text-gray-700\">Upcoming Events</h3>\r\n                    <p className=\"text-3xl font-bold text-purple-600\">2</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <h3 className=\"text-xl font-semibold mb-4 text-gray-700\">Recent Activities</h3>\r\n            <div className=\"space-y-4\">\r\n              {[\r\n                { title: 'Earthquake Safety Module Completed', time: '2 hours ago', icon: FaBook, color: 'blue' },\r\n                { title: 'Assignment Submitted: Flood Prevention', time: 'Yesterday', icon: FaClipboardList, color: 'green' },\r\n                { title: 'Mock Drill Scheduled', time: '3 days ago', icon: FaCalendarAlt, color: 'purple' }\r\n              ].map((activity, index) => (\r\n                <div key={index} className=\"flex items-center p-4 bg-white rounded-lg shadow-md border-l-4 border-${activity.color}-500 hover:bg-${activity.color}-50 transition-colors\">\r\n                  <div className={`bg-${activity.color}-100 p-3 rounded-full mr-4`}>\r\n                    <activity.icon className={`text-${activity.color}-500`} />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-medium text-gray-800\">{activity.title}</p>\r\n                    <p className=\"text-sm text-gray-500\">{activity.time}</p>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        );\r\n      case 'courses':\r\n        return (\r\n          <div className=\"bg-white rounded-lg shadow-md p-6 w-full\">\r\n            <h2 className=\"text-2xl font-bold mb-4 text-gray-800 border-b pb-2\">My Courses</h2>\r\n            <p className=\"text-gray-700\">Your enrolled courses will appear here.</p>\r\n          </div>\r\n        );\r\n      case 'assignments':\r\n        return (\r\n          <div className=\"bg-white rounded-lg shadow-md p-6 w-full\">\r\n            <h2 className=\"text-2xl font-bold mb-4 text-gray-800 border-b pb-2\">Assignments</h2>\r\n            <p className=\"text-gray-700\">Your assignments will appear here.</p>\r\n          </div>\r\n        );\r\n      case 'notifications':\r\n        return (\r\n          <div className=\"bg-white rounded-lg shadow-md p-6 w-full\">\r\n            <h2 className=\"text-2xl font-bold mb-4 text-gray-800 border-b pb-2\">Notifications</h2>\r\n            <p className=\"text-gray-600\">Your notifications will appear here.</p>\r\n          </div>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-700 font-medium\">Loading your dashboard...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-100 p-4 sm:p-6 lg:p-8\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        {/* Header with welcome banner */}\r\n        <div className=\"bg-gradient-to-r from-blue-600 to-indigo-700 rounded-xl shadow-lg p-6 mb-8 text-white\">\r\n          <div className=\"flex flex-col md:flex-row items-center justify-between\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold\">Welcome back, {user?.name || 'Student'}!</h1>\r\n              <p className=\"mt-2 text-blue-100\">Your disaster management training dashboard</p>\r\n            </div>\r\n            <div className=\"mt-4 md:mt-0 flex items-center\">\r\n              {user?.profilePic ? (\r\n                <img \r\n                  src={user.profilePic} \r\n                  alt=\"Profile\" \r\n                  className=\"w-16 h-16 rounded-full object-cover border-2 border-white shadow\" \r\n                />\r\n              ) : (\r\n                <img \r\n                  src=\"/uploads/default.png\" \r\n                  alt=\"Default Profile\" \r\n                  className=\"w-16 h-16 rounded-full object-cover border-2 border-white shadow\" \r\n                />\r\n              )}\r\n              <div className=\"ml-4\">\r\n                <p className=\"font-medium\">{user?.username || 'student@example.com'}</p>\r\n                <p className=\"text-sm text-blue-200\">Student</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex flex-col md:flex-row gap-6\">\r\n          {/* Sidebar */}\r\n          <div className=\"w-full md:w-64 bg-white rounded-xl shadow-lg p-5 h-fit\">\r\n            <h2 className=\"text-lg font-bold text-gray-800 mb-4 border-b pb-2\">Navigation</h2>\r\n            <nav className=\"space-y-2\">\r\n              {[\r\n                { name: 'Overview', id: 'overview', icon: FaBook },\r\n                { name: 'My Courses', id: 'courses', icon: FaBook },\r\n                { name: 'Assignments', id: 'assignments', icon: FaClipboardList },\r\n                { name: 'Notifications', id: 'notifications', icon: FaBell },\r\n              ].map((item) => (\r\n                <button\r\n                  key={item.id}\r\n                  onClick={() => setActiveTab(item.id)}\r\n                  className={`flex items-center w-full px-4 py-3 text-left rounded-lg transition-all ${activeTab === item.id \r\n                    ? 'bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-md' \r\n                    : 'hover:bg-gray-100 text-gray-700'}`}\r\n                >\r\n                  <item.icon className={`mr-3 ${activeTab === item.id ? 'text-white' : 'text-blue-500'}`} />\r\n                  <span className=\"font-medium\">{item.name}</span>\r\n                </button>\r\n              ))}\r\n              \r\n              {/* Profile and Logout */}\r\n              <div className=\"pt-4 mt-4 border-t border-gray-200\">\r\n                <button\r\n                  onClick={() => router.push('/profile')}\r\n                  className=\"flex items-center w-full px-4 py-3 text-left rounded-lg hover:bg-gray-100 text-gray-700 transition-all\"\r\n                >\r\n                  <FaUserCircle className=\"mr-3 text-blue-500\" />\r\n                  <span className=\"font-medium\">My Profile</span>\r\n                </button>\r\n                \r\n                <button\r\n                  onClick={logout}\r\n                  className=\"flex items-center w-full px-4 py-3 text-left rounded-lg hover:bg-red-50 text-red-600 transition-all mt-2\"\r\n                >\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 mr-3\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\r\n                  </svg>\r\n                  <span className=\"font-medium\">Logout</span>\r\n                </button>\r\n              </div>\r\n            </nav>\r\n          </div>\r\n          \r\n          {/* Main Content */}\r\n          <div className=\"flex-1\">\r\n            {renderTabContent()}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Add the diagnostic tool for debugging authentication issues */}\r\n      <AuthDiagnosticTool />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}