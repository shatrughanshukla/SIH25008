{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shivansh%20Rana/Desktop/DTU%20Academic/Codes/WEBD/SIH25008/frontend/src/app/auth/success/page.js"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { useToast } from '@/app/context/ToastContext';\n\nexport default function AuthSuccess() {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const toast = useToast();\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(true);\n  \n  // Display a message to the user immediately\n  useEffect(() => {\n    toast.showSuccessToast('Login successful! Redirecting to dashboard...');\n  }, [toast]);\n\n  useEffect(() => {\n    const token = searchParams.get('token');\n    const userId = searchParams.get('userId');\n\n    console.log('Auth Success Page - Token:', token ? 'Present' : 'Missing');\n    console.log('Auth Success Page - UserId:', userId ? 'Present' : 'Missing');\n\n    if (token && userId) {\n      // Fetch user data to get role and other information\n      const apiUrl = 'http://localhost:5000/api/users/profile';\n      console.log('Fetching user profile from:', apiUrl);\n      \n      fetch(apiUrl, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      })\n        .then(response => {\n          console.log('Profile API Response Status:', response.status);\n          if (!response.ok) {\n            throw new Error(`Failed to fetch user profile: ${response.status}`);\n          }\n          return response.json();\n        })\n        .then(userData => {\n          console.log('User data received:', userData);\n          // Create user object with token and user data\n          const user = {\n            _id: userId,\n            name: userData.name,\n            email: userData.email,\n            role: userData.role || 'student', // Default to student if role is missing\n            token: token\n          };\n\n          console.log('Saving user to localStorage:', user);\n          // Save user to localStorage\n          localStorage.setItem('user', JSON.stringify(user));\n          \n          // Show success message\n          toast.showSuccessToast('Successfully logged in with Google!');\n          setLoading(false);\n          \n          // Redirect based on user role\n          const redirectPath = userData.role === 'teacher' ? '/dashboard/teacher' : '/dashboard/student';\n          console.log('Redirecting to:', redirectPath);\n          \n          // Add a small delay before redirecting to ensure localStorage is updated\n          setTimeout(() => {\n            router.push(redirectPath);\n          }, 1000);\n        })\n        .catch(error => {\n          console.error('Error during Google auth success:', error);\n          setError(error.message);\n          setLoading(false);\n          toast.showErrorToast(`Authentication error: ${error.message}`);\n          setTimeout(() => {\n            router.push('/login');\n          }, 3000);\n        });\n    } else {\n      setError('Missing token or user ID');\n      setLoading(false);\n      toast.showErrorToast('Authentication failed. Missing token or user ID.');\n      setTimeout(() => {\n        router.push('/login');\n      }, 3000);\n    }\n  }, [searchParams, router, toast]);\n\n  return (\n    <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-100\">\n      <div className=\"w-full max-w-md p-8 space-y-8 bg-white rounded-lg shadow-md\">\n        <div className=\"text-center\">\n          <h2 className=\"mt-6 text-3xl font-extrabold text-gray-900\">\n            {error ? 'Authentication Error' : 'Completing login...'}\n          </h2>\n          <p className=\"mt-2 text-sm text-gray-600\">\n            {error \n              ? `Error: ${error}. Redirecting to login page...` \n              : 'Please wait while we redirect you to your dashboard.'}\n          </p>\n          {/* Debug info - only visible during development */}\n          <div className=\"mt-4 p-4 bg-gray-100 rounded text-left text-xs\">\n            <p>Debug Info:</p>\n            <p>Token: {searchParams.get('token') ? 'Present' : 'Missing'}</p>\n            <p>User ID: {searchParams.get('userId') ? 'Present' : 'Missing'}</p>\n            <p>Current URL: {typeof window !== 'undefined' ? window.location.href : 'N/A'}</p>\n          </div>\n        </div>\n        <div className=\"flex justify-center\">\n          {loading ? (\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n          ) : error ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-12 w-12 text-red-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-12 w-12 text-green-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n            </svg>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 270, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shivansh%20Rana/Desktop/DTU%20Academic/Codes/WEBD/SIH25008/frontend/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}